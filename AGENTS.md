# AGENTS

> **Аудитория**: Инженерные агенты на основе LLM

Этот файл предоставляет руководство для автономных агентов программирования, работающих в репозитории **MCP Atlassian**.

---

## Карта репозитория

| Путь | Назначение |
| --- | --- |
| `src/mcp_atlassian/` | Исходный код библиотеки (Python ≥ 3.10) |
| `  ├─ jira/` | Jira клиент, миксины и операции |
| `  ├─ confluence/` | Confluence клиент, миксины и операции |
| `  ├─ models/` | Pydantic модели данных для ответов API |
| `  ├─ servers/` | Реализации FastMCP серверов |
| `  └─ utils/` | Общие утилиты (аутентификация, логирование, SSL) |
| `tests/` | Набор тестов Pytest с фикстурами |
| `scripts/` | Скрипты настройки OAuth и тестирования |

---

## Обязательный рабочий процесс разработки

```bash
uv sync --frozen --all-extras --dev  # установка зависимостей
pre-commit install                    # настройка хуков
pre-commit run --all-files           # Ruff + Prettier + Pyright
uv run pytest                        # запуск полного набора тестов
```

*Тесты должны проходить* и *lint/типизация должны быть чистыми* перед коммитом.

---

## Основные паттерны MCP

**Именование инструментов**: `{service}_{action}` (например, `jira_create_issue`)

**Архитектура**:
- **Миксины**: Функциональность разделена на специализированные миксины, расширяющие базовые клиенты
- **Модели**: Все структуры данных расширяют базовый класс `ApiModel`
- **Аутентификация**: Поддерживает API токены, PAT токены и OAuth 2.0

---

## Правила разработки

1. **Управление пакетами**: ИСПОЛЬЗУЙТЕ ТОЛЬКО `uv`, НИКОГДА `pip`
2. **Ветвление**: НИКОГДА не работайте на `main`, всегда создавайте feature ветки
3. **Типобезопасность**: Все функции требуют аннотаций типов
4. **Тестирование**: Новые функции требуют тестов, исправления багов требуют регрессионных тестов
5. **Коммиты**: Используйте трейлеры для атрибуции, никогда не упоминайте инструменты/ИИ

---

## Соглашения о коде

* **Язык**: Python ≥ 3.10
* **Длина строки**: максимум 88 символов
* **Импорты**: Абсолютные импорты, отсортированные ruff
* **Именование**: `snake_case` для функций, `PascalCase` для классов
* **Docstrings**: Google-стиль для всех публичных API
* **Обработка ошибок**: Только специфичные исключения

---

## Руководящие принципы разработки

1. Делайте то, что было запрошено; ничего больше, ничего меньше
2. НИКОГДА не создавайте файлы, если это не абсолютно необходимо
3. Всегда предпочитайте редактирование существующих файлов
4. Следуйте установленным паттернам и поддерживайте согласованность
5. Запускайте `pre-commit run --all-files` перед коммитом
6. Исправляйте баги немедленно при сообщении о них

---

## Краткая справка

```bash
# Запуск сервера
uv run mcp-atlassian                 # Запустить сервер
uv run mcp-atlassian --oauth-setup   # Мастер настройки OAuth
uv run mcp-atlassian -v              # Подробный режим

# Рабочий процесс Git
git checkout -b feature/description   # Новая функция
git checkout -b fix/issue-description # Исправление бага
git commit --trailer "Reported-by:<name>"      # Атрибуция
git commit --trailer "Github-Issue:#<number>"  # Ссылка на issue
```
